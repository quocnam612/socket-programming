\section{Quy trình thực hiện}

\subsection{Xây dựng RTP/RTSP server và client}

\subsubsection{Hoàn thiện RtpPacket.py - Giao thức RTP của server}
Hoàn thiện hàm encapsulation - encode(): 
\lstinputlisting[language=Python]{code/encode.py}
\textbf{header}: mảng byte có kích thước 12 bytes
\begin{itemize}
    \item Byte thứ 1 (8 bits): chứa trường Version, Padding, Extension, Contributing Source Count và có dạng V-V-P-X-CC-CC-CC-CC
    \begin{itemize}
        \item version \& 0x03: lấy 2 bit cuối của version (03[16] = 0000 0011[2])
        \item << 6: dịch trái 6 bit để đưa về vị trí 2 bit đầu tiên trong byte (eg. V = 2 => 1100 0000[2])
        \item Tương tự với các trường padding, extension, lúc này còn 4 bit cuối cùng là CC
        \item cc \& 0x0F: chỉ lấy 4 bit cuối của cc (0F[16] = 0000 1111[2])
    \end{itemize}
    \item Byte thứ 2 (8 bits): chứa trường Marker Bit, Payload Type và có dạng M-PT-PT-PT-PT-PT-PT-PT (các logic tương tự byte 1)
    \item Byte thứ 3-4 (16 bits): chỉ chứa trường Sequence Number
    \begin{itemize}
        \item (seqnum >> 8) \& 0xFF: lấy 8 bit đầu của seqnum (0xFF[16] = 1111 1111[2])
        \item seqnum \& 0xFF: lấy 8 bit cuối của seqnum
    \end{itemize}
    \item Byte thứ 5-8 (32 bits): chỉ chứa trường Timestamp, logic tương tự byte 3-4
    \item Byte thứ 9-12 (32 bits): chỉ chứa trường Synchronization Source Identifier (SSRC), logic tương tự byte 3-4
\end{itemize}

Phần header trong python sẽ có dạng như sau, với mỗi dòng tương ứng với 4 bytes (32 bits):
\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\linewidth]{img/realRTP.png}
    \caption{Cấu trúc mảng header}
\end{figure} 

\subsubsection{Hoàn thiện Client.py - Giao thức RTSP của client}
Hoàn thiện hàm gửi RTSP request - sendRtspRequest(): 
\lstinputlisting[language=Python]{code/sendRtspRequest.py}


Hoàn thiện hàm phân tích RTSP reply - parseRtspReply(): 
\lstinputlisting[language=Python]{code/parseRtspReply.py}


Hoàn thiện hàm kết nối tới port của RTP - openRtpPort(): 
\lstinputlisting[language=Python]{code/openRtpPort.py}


\subsection{Bổ sung HD video streaming}


\subsection{Bổ sung client cache}

